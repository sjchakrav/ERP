YUI.add("dropdown",function(e){"use strict";var t,n;t={css:{closed:"ui-dropdown-closed",shim:"ui-dropdown-shim",label:'span[data-action="toggle"]',items:"[data-value]",itemSelected:"ui-dropdown-item-selected",hasDialogArrow:"ui-dropdown-has-dialog-arrow",dialogArrow:"ui-dialog-arrow",useCheckMarks:"ui-dropdown-use-checkboxes"},options:{hasDialogArrow:!1,useCheckMarks:!1}},e.namespace("Views").Dropdown=n=e.Base.create("Dropdown",e.FlickrView,[],{initializer:function(e){if(e.activate===!1)return;this.activate()},activate:function(){var n=this,r=this.get("container"),i;this.close(),this._items={},e.Lang.isArray(this.get("selected"))||this.set("selected",[this.get("selected")]),r.all(t.css.items).each(function(e){var t=e.getData();n._items[t.value]={text:t.text||'no data-text for "'+t.value+'"',sub:t.sub,node:e}}),this.labelEl=r.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" />'),r.insert(this.labelEl,0)),i=this.get("staticLabel")||this.get("defaultLabel"),i&&(i===!0?this.labelEl.set("text","set staticLabel/defaultLabel to a string, not `true`"):this.labelEl.set("text",i)),this.get("hasDialogArrow")&&!r.hasClass(t.css.hasDialogArrow)&&r.addClass(t.css.hasDialogArrow),r.hasClass(t.css.hasDialogArrow)&&(this.dialogArrowEl=r.one(t.css.dialogArrow),this.dialogArrowEl||(this.dialogArrowEl=e.Node.create('<span class="ui-dialog-arrow" />'),r.insert(this.dialogArrowEl,1))),this.get("useCheckMarks")&&!r.hasClass(t.css.useCheckMarks)&&r.addClass(t.css.useCheckMarks),this.select();if(this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this),":set":function(t,r){t.halt();if(!n.get("multiSelect")&&!n.get("multiSelectSub")&&e.Array.indexOf(n.get("selected"),r.value)>=0)return n.close();n.select(r.value,r)}})},select:function(n,r,i){var s=this,o=n?this._items[n]:null,u=!0,a=[],f;o&&e.Array.indexOf(this.get("selected"),n)>=0&&(this.get("multiSelect")||this.get("multiSelectSub"))?(a=this.get("selected"),!o.sub&&this.get("multiSelect")&&a.length>this.get("minimumSelected")?(a.splice(e.Array.indexOf(this.get("selected"),n),1),u=!1):o.sub&&(a.splice(e.Array.indexOf(this.get("selected"),n),1),u=!1),this.set("selected",a)):o&&(o.sub?(a.push(n),this.get("selectParent")&&a.push(o.sub),e.Array.each(this.get("selected"),function(e){s._items[e].sub===o.sub?a.push(e):s.get("multiSelect")&&!s._items[e].sub&&a.push(e)})):this.get("multiSelect")?(a=this.get("selected"),a.push(n)):a.push(n),this.set("selected",a)),i||this.close(),f={clicked:o?{text:o.text,value:n,sub:o.sub,itemEl:o.node,isChecked:u}:null,data:r,selections:a},this.fire("selected",f),this.update(n,f,t)},update:function(t,n,r){var i=this,s=n.clicked,o=this.get("selected"),u=this.get("defaultLabel")||"[Unable to select a default item]";this.get("staticLabel")||(this.get("labelFunction")?u=this.get("labelFunction").apply(this,[t]):s?n.data&&n.data.text&&n.data.text!==s.text?u=n.data.text:u=s.text:o.length>0&&i._items[o[0]]&&(u=i._items[o[0]].text),this.labelEl.set("textContent",u||"[!empty data-text!]")),this.get("container").all(r.css.items).removeClass(r.css.itemSelected),e.Array.each(o,function(e){i._items[e]&&i._items[e].node.addClass(r.css.itemSelected)})},toggle:function(e){e&&e.halt(),this._open?this.close(e):this.open(e)},open:function(e){var n=this.get("container"),r=0,i=0,s=30;this._open=!0,this.get("shouldCreateShim")&&this._shimUp(),n.removeClass(t.css.closed),this.get("autoSizeMenu")&&(r=parseInt(this.labelEl.getComputedStyle("width"),10),i=parseInt(n.one("ul").getComputedStyle("width"),10),r+s>i&&n.one("ul").setStyles({width:r+s})),(!e||!e.silent)&&this.fire("open",e)},close:function(e){e&&e.halt(),this._open=!1,this._shimUp(!1),this.fire("close",e),this.get("container").addClass(t.css.closed)},_shimUp:function(n){if(n===!1){if(!this._shim)return;this._shim.detach("click").remove(),this._shim=null;return}this._shim=e.Node.create("<div />"),this._shim.addClass(t.css.shim),this._shim.on("click",this.close.bind(this)),this.get("container").appendChild(this._shim)},disable:function(){var e=this.get("container");this.set("disabled",!0),this.close(),e.addClass(t.css.disabled),e.detach()},destructor:function(){this._shimUp(!1),this._items=null,this.labelEl=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:[]},disabled:{value:!1},hasDialogArrow:{value:!1},useCheckMarks:{value:!1},multiSelect:{value:!1},multiSelectSub:{value:!1},selectParent:{value:!0},minimumSelected:{value:0},staticLabel:{value:!1},defaultLabel:{value:!1},labelFunction:function(){},shouldCreateShim:{value:!0},autoSizeMenu:{value:!0}}})},"@VERSION@",{requires:["flickr-view","flickrui-css"]});
YUI.add("footer-full-view",function(e){var t=["en-US","zh-HK","de-DE","es-US","fr-FR","ko-KR","it-IT","pt-BR","vn-VN","id-ID"],n={"en-US":"English","de-DE":"Deutsch","es-US":"Espa\u00f1ol","fr-FR":"Fran\u00e7ais","ko-KR":"\ud55c\uae00","it-IT":"Italiano","pt-BR":"Portugu\u00eas","vn-VN":"Ti\u1ebfng Vi\u1ec7t","id-ID":"Bahasa Indonesia","zh-HK":"\u7e41\u9ad4\u4e2d\u6587"};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML('<div class="footer-full-content"></div>'),this.appStateParams=e,this.set("hideOptOutBanner",e.hideOptOutBanner),this.set("showOptOutBanner",e.showOptOutBanner),this.set("hideMobileBanner",e.hideMobileBanner),this},subviewConfig:{},loadState:function(){var r,i,s;s=this.appContext.auth&&this.appContext.auth.csrf?this.appContext.auth.csrf:"",this.lang=this.appContext.lang,this.menuLangs=[],this.lang==="zh-Hant-HK"&&(this.lang="zh-HK"),this.lang.toLowerCase()==="vi-vn"&&(this.lang="vn-VN"),this.selectedLang={code:this.lang,name:n[this.lang],csrf:s};for(r=0,i=t.length;r<i;r++){if(t[r]===this.lang)continue;typeof t[r]=="string"&&this.menuLangs.push({code:t[r].toLowerCase(),name:n[t[r]],csrf:s})}return e.Promise.resolve()},buildContainer:function(){var t={},n={},r=this.appContext.flipper.toJSON();return this.get("viewer")&&(t=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),n={flippers:r,displayLangs:this.displayLangs,selectedLang:this.selectedLang,menuLangs:this.menuLangs},YUI.Env.isServer?n.pageUrl=this.appContext.request.url:n.pageUrl=window.location.pathname,this.appContext.getCookie("mobile_allow_www")&&!this.appStateParams.hideMobileBanner?n.isOptedOutOfMobile=!this.get("hideMobileBanner"):!this.appContext.getCookie("mobile_allow_www")&&this.get("hideMobileBanner")&&(n.hasNoOptOut=!0),this.setContainerHTML(this.templates("footer-full")(n)),this},activate:function(){var t=this.get("container"),n=t.one(".lang-switcher"),r=n.one("a"),i=t.one(".foot-mobile-banner a"),s=t.one(".opt-out-www");return this.menuLangsFormatted=this.menuLangs.map(function(e){return{href:"/change_language.gne?lang="+e.code+"&csrf="+e.csrf,text:e.name}}),this.registerEventHandler(n.on("click",function(t){t.preventDefault(),r.addClass("dimmed");var i=new e.Views.FluidDroparound({anchorOffsetHorizontal:n.get("offsetWidth"),appContext:this.appContext,showDropArrow:!0,observePageResize:!0,dismissOnOverlayClick:!0,anchorElement:n.one(".arrow"),classList:["lang-droparound"],menuItems:this.menuLangsFormatted});i.show(),this.registerEventHandler(i.on("closeDroparound",function(e){r.removeClass("dimmed")}),this)},this)),i&&this.registerEventHandler(i.on("click",function(e){this.appContext.removeCookie({cookieName:"mobile_allow_www",path:"/"})},this)),s&&this.registerEventHandler(s.on("click",function(e){this.appContext.setCookie({cookieName:"mobile_allow_www",path:"/",cookieValue:1})},this)),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-footer-full","footer-full-css","url-helper","flickrui-css","flickrui-dialogs-css","dropdown","fluid-droparound-view"],langBundles:["common"]});
YUI.add("photolist-aft-helper",function(e){"use strict";e.PhotolistAftHelper=function(e){var t=e.onSubviewEvent;this.appContext=e.appContext,this.viewName=e.name,YUI.Env.isServer||this.appContext.clientMetrics.setPendingMeasurement(e.name,!0),e.onSubviewEvent=function(n,r){(r&&r[0]==="atfVisible"||r[0]==="atfActivated")&&this.aftHelper.handleAFTResult(n,r),t&&t.call(e,n,r)}},e.PhotolistAftHelper.prototype.handleAFTResult=function(e,t){var n=t[0];this.paftResults||(this.paftResults={},this.paftResults[e]={}),this.paftResults[e][n]=t[1]||(new Date).getTime(),this.beaconIfAllAFTResultsComplete(n)},e.PhotolistAftHelper.prototype.beaconIfAllAFTResultsComplete=function(t){var n=0,r;if(this.allResultsReceived)return;if(!this.paftResults)return;this.allResultsReceived=Object.keys(this.paftResults).every(function(e){return r=this.paftResults[e][t],typeof r=="undefined"?!1:(r>n&&(n=r),!0)}.bind(this)),this.allResultsReceived&&t==="atfVisible"&&(this.appContext.hasClientSideRouted()?(this.appContext.clientMetrics.mark("AFT_CL",n),this.appContext.clientMetrics.mark("AFT",n)):(e.config.win.performance&&e.config.win.performance.timing&&(n-=e.config.win.performance.timing.navigationStart),this.appContext.clientMetrics.record("AFT_SV",n),this.appContext.clientMetrics.record("AFT",n)),this.appContext.clientMetrics.setPendingMeasurement(this.viewName,!1),this.appContext.clientMetrics.beacon())}},"@VERSION@",{affinity:"",requires:["flickr-promise","event-custom"]});
YUI.add("album-page-view",function(e){var t=190,n=430,r=null,i=3;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(s){return this.albumId=s.albumId,this.isOwner=s.isOwner,this.isTwitterbot=s.isTwitterbot,this.albumPhotoListLayoutStyle=s.albumPhotoListLayoutStyle,s.id=s.albumId,s.modelRegistryName="set-models",s.maxNumAttrName="totalCount",this.pageParams=s.pageParams,s.photoListConfig={modelParams:{registryName:"set-models",modelIdOrAttributes:s.albumId,collectionAttributeName:"photoPageList"},parentName:this.name,pageParams:s.pageParams,contextSuffix:"album-"+s.albumId,measureAFT:!0,maintainScrollPosition:!1,scrollToWithId:s.withPhotoId},s.photoListConfig.layout={targetRowHeight:this.albumPhotoListLayoutStyle==="justified"?t:n,fullWidthBreakoutRowCadence:this.albumPhotoListLayoutStyle==="justified"?r:i,awakeBoundsToViewportSizeRatio:5,containerPadding:{top:4,right:0,bottom:4,left:0},itemSpacing:{horizontal:4,vertical:4}},this.aftHelper=new e.PhotolistAftHelper(this),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"album-toolbar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-header-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"pagination-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return this.pageParams.viewPageSize?!1:!0}},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var e=this;return this.appContext.getModel("set-models",this.albumId).then(function(t){e.set("albumModel",t)})},buildContainer:function(){var e;return e={"global-nav-view":this.subviews["global-nav-view"].get("container"),"album-toolbar-view":this.subviews["album-toolbar-view"].get("container"),"album-header-view":this.subviews["album-header-view"].get("container"),"photo-list-view":this.subviews["photo-list-view"].get("container"),"pagination-view":this.subviews["pagination-view"]?this.subviews["pagination-view"].get("container"):"","footer-full-view":this.subviews["footer-full-view"].get("container"),flippers:this.appContext.flipper.toJSON()},this.setContainerHTML(this.templates("album-page")(e)),this},buildHeadContainer:function(){var t=this.get("albumModel"),n=t.getValue("photoPageList").getList(),r="summary",i=[],s,o=(this.pageParams.nominalPage-1)*this.pageParams.viewPageSizeForShare||0,u,a;if(this.isTwitterbot&&n.length-o>=4){r="gallery";for(a=0;a<Math.min(n.length-o,4);a++)n[o+a]?i.push({property:"twitter:image"+a,content:n[o+a].getSizeToFit({width:640,height:640}).url}):e.Flog.error("[album-page-view] missing album photo in album list: "+(o+a))}t.registry?s=t.registry.getSizeToFit(this.albumId,{width:640,height:640}):e.Flog.error("[album-page-view] Missing album model registry!"),u=this.templates("dynamic-page-head")({title:t.getValue("title"),description:t.getValue("description"),url:t.getValue("url"),fullURL:e.url(t.getValue("url")),openGraphImageURL:e.URLHelper.addProtocolToURL(s.url),openGraphaImageWidth:s.width,openGraphaImageHeight:s.height,ownerURL:t.getValue("owner").getValue("url"),twitterCardType:r,twitterImages:i,flickrType:"set",domain:e.url()}),u+=this.templates("head-meta")({isName:!0,metaName:"robots",metaValue:"noarchive"}),u+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, initial-scale=1, maximum-scale=1"}),u+=this.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:"noarchive"}),this.set("headContainer",u),YUI.Env.isServer||this.updateHead()},activate:function(){var s=this,o=this.get("albumModel"),u=o.getValue("isOwner");return e.later(100,this,function(){e.use("photo-page-scrappy-view")}),e.on("albumToolbarView:layoutChange",function(e){var o=s.subviews["photo-list-view"],u=o.photoListLayout;u.targetRowHeight=e==="justified"?t:n,u.fullWidthBreakoutRowCadence=e==="justified"?r:i,o.setItems(s.get("albumModel").getValue("photoPageList").getList())}),u||this.appContext.getViewCounter().recordAlbumView({albumOwnerID:o.getValue("owner").getValue("id"),albumID:o.getValue("id"),referrer:this.appContext.getReferrer()}),this},onSubviewEvent:function(e,t){t&&t[0]==="newPhotoAddedToAlbum"&&this.subviews["photo-list-view"].setItems(this.get("albumModel").getValue("photoPageList").getList())},getTrackingSegments:function(){return{vwrOwner:this.isOwner?1:0}}},{ATTRS:{spaceid:{value:792600538}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","set-models","hermes-template-album-page","hermes-template-dynamic-page-head","hermes-template-head-meta","album-page-css","album-toolbar-view","album-header-view","photo-list-view","footer-full-view","photolist-aft-helper","url-helper"],langBundles:["album-page"]});
YUI.add("album-privacy-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photosets-getPhotos"].run(t,this.appContext)}},attributes:{totalCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},hasPhotosPrivate:{readOnly:!0,derivedBy:["totalCount","countPhotosPublic"],defaultFn:function(e){return this.getValue(e,"totalCount")-this.getValue(e,"countPhotosPublic")}},countPhotosFamily:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},countPhotosFriend:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},countPhotosFriendFamily:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},countPhotosPublic:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-getPhotos-fetcher"]});
YUI.add("hermes-lang-client-app",function(e,t){e.Intl.add("hermes/client-app","en-US",{SAVING_LAST_ACTIONS:["Hey! We\u2019re still saving your last actions, you might lose them if you leave this page."],UPLOAD_IN_PROGRESS:["Wait! Your photos are still on the way to our servers. They might not get there if you leave this page before they arrive."]})},"@VERSION@",{requires:["intl"]});
