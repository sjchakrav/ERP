YUI.add("hermes-template-person-card",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+="\n					"+l((i=(i=e.person,i==null||i===!1?i:i.realname),typeof i===f?i.apply(e):i))+"\n					",s=n["if"].call(e,e.personLocation,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(s||s===0)r+=s;return r+="\n				",r}function d(e,t){return" - "}function v(e,t){var r="",i;r+="\n			",i=n.each.call(e,e.photostream,{hash:{},inverse:c.noop,fn:c.program(5,m,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function m(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.needsInterstitial,{hash:{},inverse:c.program(8,y,t),fn:c.program(6,g,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function g(e,t){var r="",i;return r+='\n					<a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===f?i.apply(e):i),r+=l(i)+'" title="',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+'" width="'+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.width),typeof i===f?i.apply(e):i))+'" height="'+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.height),typeof i===f?i.apply(e):i))+'" style="background: url(https://s.yimg.com/pw/images/spaceball.gif);" data-track="personCardRecentPhotosClick"></a>\n				',r}function y(e,t){var r="",i;return r+='\n					<a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===f?i.apply(e):i),r+=l(i)+'" title="',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+'" style="background: url('+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.displayUrl),typeof i===f?i.apply(e):i))+');" data-track="personCardRecentPhotosClick"></a>\n				',r}function b(e,t){var r="",i,s;return r+='\n			<span class="tertiary">',s={hash:{intlName:"person.NO_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</span>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='\n<div>\n	<section>\n		<div class="follow-subview">',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["follow-view"],a):h.call(t,"outlet",t["follow-view"],a)))+'</div>\n\n		<div class="attribution">\n			<a href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.photostream),typeof o===f?o.apply(t):o))+'" data-track="personCardAttributionNameClick">\n				<h3 class="fade-out">'+l((o=(o=t.person,o==null||o===!1?o:o.username),typeof o===f?o.apply(t):o))+'</h3>\n			</a>\n		</div>\n		<div class="info">\n			<span class="secondary realname fade-out">\n				',u=n["if"].call(t,(o=t.person,o==null||o===!1?o:o.realname),{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n				",(u=n.personLocation)?u=u.call(t,{hash:{},data:i}):(u=t.personLocation,u=typeof u===f?u.apply(t):u),s+=l(u)+'\n			</span>\n		</div>\n\n		<div class="recent-photos">\n		',u=n["if"].call(t,t.photostream,{hash:{},inverse:c.program(10,b,i),fn:c.program(4,v,i),data:i});if(u||u===0)s+=u;return s+='\n		</div>\n	</section>\n</div>\n\n<div class="links secondary">\n	<a href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.sendFlickrMail),typeof o===f?o.apply(t):o))+'" data-track="personCardMessageClick">',a={hash:{intlName:"person.MESSAGE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<a href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.albums),typeof o===f?o.apply(t):o))+'" data-track="personCardAlbumsClick">',a={hash:{intlName:"person.ALBUMS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<a href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.favorites),typeof o===f?o.apply(t):o))+'" data-track="personCardFavesClick">',a={hash:{intlName:"person.FAVES"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<a class="align-right" href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.profile),typeof o===f?o.apply(t):o))+'" data-track="personCardProfileClick">',a={hash:{intlName:"person.PROFILE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"</a>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/person-card",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("person-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("person-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){var t=this,n={contentType:7};return this.nsid?n.id=this.nsid:n.pathAlias=this.pathAlias,(new e.FlickrPromise({person:this.appContext.getModel("person-models",n),photostream:this.appContext.getModel("photostream-models",n),personProfile:this.appContext.getModel("person-profile-models",n)})).then(function(e){return t.personModel=e.person,t.personLocation=e.personProfile.getValue("location"),e.photostream.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.photostreamPhotos=e})},function(e){t.loadingError=!0,e.code===1&&e.message==="User not found"&&(t.badUser=!0)})},buildContainer:function(){var t,n;return this.loadingError?this.badUser?n='<span class="no-user">'+this.intlMessage({intlName:"person.NO_LONGER_ON_FLICKR"})+"</span>":n='<span class="error-user">'+this.intlMessage({intlName:"person.ERROR_LOADING"})+"</span>":(t=this.personModel.toJSON(),n=this.templates("person-card")({person:t,photostream:this.photostreamPhotos.map(function(e){return e.toJSON()}),personLocation:this.personLocation,personURLS:e.URLHelper.generatePersonUrls(this.personModel),"follow-view":this.subviews["follow-view"].get("container")})),this.setContainerHTML(n),this},activate:function(){var e=this.get("container"),t=e.one(".follow-view"),n=t.one(".relationship"),r=t.one(".relationship > .is-following"),i=e.one(".attribution");return n?r&&i.addClass("shorter"):i.addClass("full"),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-person-card","person-card-css","url-helper"],langBundles:["person","common"]});
YUI.add("person-menu-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create("person-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".no-menu"].concat(e.excludeSelectors||[]),this.personSelector=".avatar.person, .photo-attribution .attribution-icon, .comment-icon.circle-icon a, .show-person-menu",this.dialogCache=[],this.currentDialog,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},toJSON:function(){var t=e.merge(this.get("user"));return t},activate:function(){this.registerEventHandler(e.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.personSelector,this))},onClickTarget:function(t){var n=this,r;this.shouldProcessTarget(t.target)&&(t.preventDefault(),t.halt(),r=t.target.ancestor().one(this.personSelector)||t.target.ancestor(this.personSelector)||t.target.ancestor("a"),this.createParamsAndManageState(r),e.rapidTracker.beacon(n.name,"personCardOpened"))},shouldProcessTarget:function(e){return e.ancestor()!==null&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(t){var n={appContext:this.appContext,isActiveViewAgnostic:!0},r="",i;return r=t.getData("person-nsid")||t.ancestor().getData("person-nsid"),r||(i=t.getAttribute("href")||t.ancestor().getAttribute("href"),i.indexOf("/photos")===0?r=i.replace("/photos/","").replace("/",""):i.indexOf("/groups/")===0&&(r=i.slice(i.lastIndexOf("/")+1))),e.TypeValidator.matches.nsid(r)?n.nsid=r:n.pathAlias=r,n.signature=r,n},createDialog:function(t,n){var r,i=this;this.fire("open"),e.fire("personMenuOpen"),this.dialogCache.some(function(e){return e.key===t.signature?(r=e.dialog,!0):!1}),r?r.set("anchorElement",n.ancestor().hasClass("comment-icon")?n.ancestor():n):(r=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,observePageResize:!0,anchorElement:n.ancestor().hasClass("comment-icon")?n.ancestor():n,subview:new e.Views["person-card-view"](t)}),r.on("clickOverlay",function(e){i.nextElClicked=[e.clientX,e.clientY]}),r.on("closeDroparound",function(){setTimeout(function(){if(i.nextElClicked){var t=document.elementFromPoint(i.nextElClicked[0],i.nextElClicked[1]),n;t&&(n=e.one(t),n&&i.personSelector.split(",").some(function(e){return n.hasClass(e.replace(".",""))})&&i.shouldProcessTarget(n)&&i.createParamsAndManageState(n)),i.nextElClicked=null}},10)}),this.dialogCache.length>10&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:r})),this.currentDialog=r,r.show()},closeDialog:function(){this.currentDialog&&(this.currentDialog.close(),e.fire("personMenuClose"))},destructor:function(){var t=this;this.currentDialog=null,e.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=[]}})},"@VERSION@",{requires:["flickr-promise","flickr-view","account-menu-css","flickrui-css","dialog","fluid-droparound-view","person-card-view","type-validator"],langBundles:["person","common"]});
YUI.add("hermes-template-group-card",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i;r+="\n			",i=n.each.call(e,e.groupPool,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function d(e,t){var r="",i,s;r+='\n				\n				<a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===f?i.apply(e):i),r+=l(i)+'" title="',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+'" width="'+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.width),typeof i===f?i.apply(e):i))+'" height="'+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.height),typeof i===f?i.apply(e):i))+'"\n				',s=n["if"].call(e,e.needsInterstitial,{hash:{},inverse:c.program(5,m,t),fn:c.program(3,v,t),data:t});if(s||s===0)r+=s;return r+="\n				></a>\n				\n			",r}function v(e,t){return'\n					class="restricted"\n				'}function m(e,t){var n="",r;return n+='\n					style="background: url('+l((r=(r=(r=e.sizes,r==null||r===!1?r:r.sq),r==null||r===!1?r:r.displayUrl),typeof r===f?r.apply(e):r))+');"\n				',n}function g(e,t){var r="",i;r+="\n			",i=n["if"].call(e,e.canAddPhotos,{hash:{},inverse:c.program(10,b,t),fn:c.program(8,y,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function y(e,t){var r="",i,s;return r+='\n				<p class="tertiary">',s={hash:{intlName:"groups.BE_THE_FIRST"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+'</p>\n				<p class="tertiary"><a href="'+l((i=(i=e.groupURLS,i==null||i===!1?i:i.photos),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"groups.ADD_SOME_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</a></p>\n			",r}function b(e,t){var r="",i,s;return r+="\n				<p>",s={hash:{intlName:"groups.NO_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</p>\n			",r}function w(e,t){var r="",i,s;return r+='\n	<a href="'+l((i=(i=e.groupURLS,i==null||i===!1?i:i.admin),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</a>\n	",r}function E(e,t){var r="",i,s;r+="\n		",s=n["if"].call(e,(i=e.group,i==null||i===!1?i:i.isModerator),{hash:{},inverse:c.noop,fn:c.program(15,S,t),data:t});if(s||s===0)r+=s;return r+="\n	",r}function S(e,t){var r="",i,s;return r+='\n		<a href="'+l((i=(i=e.groupURLS,i==null||i===!1?i:i.admin),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</a>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='\n<div>\n	<section>\n		<div class="join-subview">\n\n			',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["join-group-view"],a):h.call(t,"outlet",t["join-group-view"],a)))+'\n\n		</div>\n\n		<div class="attribution">\n			<a href="'+l((o=(o=t.groupURLS,o==null||o===!1?o:o.about),typeof o===f?o.apply(t):o))+'">\n				<h3 class="fade-out">',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,(o=t.group,o==null||o===!1?o:o.title),a):h.call(t,"renderTrustedMarkup",(o=t.group,o==null||o===!1?o:o.title),a)))+'</h3>\n			</a>\n		</div>\n		<div class="stats">\n			<span class="secondary fade-out">',a={hash:{intlName:"groups.CREATED_YEAR",createdYear:t.createdYear},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+" - ",a={hash:{intlName:"groups.UPDATED_TIME_AGO",updatedAgo:t.updatedAgo},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</span>\n		</div>\n\n		<div class="recent-photos">\n		',u=n["if"].call(t,t.groupPool,{hash:{},inverse:c.program(7,g,i),fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+='\n		</div>\n	</section>\n</div>\n\n<div class="links secondary">\n	<a href="'+l((o=(o=t.groupURLS,o==null||o===!1?o:o.photos),typeof o===f?o.apply(t):o))+'">',a={hash:{intlName:"groups.PHOTOS_LINK_LABEL"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<a href="'+l((o=(o=t.groupURLS,o==null||o===!1?o:o.discussions),typeof o===f?o.apply(t):o))+'">',a={hash:{intlName:"groups.DISCUSSIONS_LINK_LABEL"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"</a>\n	",u=n["if"].call(t,(o=t.group,o==null||o===!1?o:o.isAdmin),{hash:{},inverse:c.program(14,E,i),fn:c.program(12,w,i),data:i});if(u||u===0)s+=u;return s+="\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/group-card",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("group-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("group-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.groupId=e.groupId,this.groupPathAlias=e.groupPathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"join-group-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,shortLabels:!0,theme:"light"}},loadState:function(){var t=this,n=this.groupId;return(new e.FlickrPromise({groupPool:this.appContext.getModel("group-pool-models",n),group:this.appContext.getModel("group-models",n),groupInfo:this.appContext.getModel("group-info-models",n)})).then(function(e){return t.groupModel=e.group,t.groupInfo=e.groupInfo,e.groupPool.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.groupPhotos=e})},function(e){t.loadingError=!0})},buildContainer:function(){var t,n,r=!1,i;return this.loadingError?n='<span class="error-group">'+this.intlMessage({intlName:"groups.ERROR_LOADING"})+"</span>":(t=this.groupModel.toJSON(),i=this.groupInfo.getValue("throttle"),r=i.mode!=="disabled"&&i.remaining>0||i.mode==="none",r&&(r=t.isMember),n=this.templates("group-card")({group:t,groupPool:this.groupPhotos.map(function(e){return e.toJSON()}),canAddPhotos:r,groupURLS:e.URLHelper.generateGroupUrls(this.groupModel),createdYear:t.dateCreated.year(),updatedAgo:this.intlMessage(e.Handlebars.helpers._friendlySinceDate(t.latestGroupActivity,!0,!0)),"join-group-view":this.subviews["join-group-view"].get("container")})),this.setContainerHTML(n),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",function(e){e.preventDefault(),console.log("join group")},".join")),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-group-card","group-card-css","url-helper","handlebars-helpers"],langBundles:["groups","relative-dates"]});
YUI.add("hermes-lang-relative-dates",function(e,t){e.Intl.add("hermes/relative-dates","en-US",{SECOND_LONG:["1 second"],SECONDS_LONG:["${time}"," seconds"],MINUTE_LONG:["1 min"],MINUTES_LONG:["${time}"," mins"],HOUR_LONG:["1 hour"],HOURS_LONG:["${time}"," hours"],DAY_LONG:["1 day"],DAYS_LONG:["${time}"," days"],MONTH_LONG:["1 month"],MONTHS_LONG:["${time}"," months"],YEAR_LONG:["1 year"],YEARS_LONG:["${time}"," years"],SECOND_SHORT:["1s"],SECONDS_SHORT:["${time}","s"],MINUTE_SHORT:["1m"],MINUTES_SHORT:["${time}","m"],HOUR_SHORT:["1h"],HOURS_SHORT:["${time}","h"],DAY_SHORT:["1d"],DAYS_SHORT:["${time}","d"],MONTH_SHORT:["1mo"],MONTHS_SHORT:["${time}","mo"],YEAR_SHORT:["1y"],YEARS_SHORT:["${time}","y"],SECOND_LONG_FUTURE:["in 1 second"],SECONDS_LONG_FUTURE:["in ","${time}"," seconds"],MINUTE_LONG_FUTURE:["in 1 min"],MINUTES_LONG_FUTURE:["in ","${time}"," mins"],HOUR_LONG_FUTURE:["in 1 hour"],HOURS_LONG_FUTURE:["in ","${time}"," hours"],DAY_LONG_FUTURE:["in 1 day"],DAYS_LONG_FUTURE:["in ","${time}"," days"],MONTH_LONG_FUTURE:["in 1 month"],MONTHS_LONG_FUTURE:["in ","${time}"," months"],YEAR_LONG_FUTURE:["in 1 year"],YEARS_LONG_FUTURE:["in ","${time}"," years"],FUTURE_SHORT_FUTURE:["in ","${time}"],SECOND_SHORT_FUTURE:["in 1s"],SECONDS_SHORT_FUTURE:["in ","${time}","s"],MINUTE_SHORT_FUTURE:["in 1m"],MINUTES_SHORT_FUTURE:["in ","${time}","m"],HOUR_SHORT_FUTURE:["in 1h"],HOURS_SHORT_FUTURE:["in ","${time}","h"],DAY_SHORT_FUTURE:["in 1d"],DAYS_SHORT_FUTURE:["in ","${time}","d"],MONTH_SHORT_FUTURE:["in 1mo"],MONTHS_SHORT_FUTURE:["in ","${time}","mo"],YEAR_SHORT_FUTURE:["in 1y"],YEARS_SHORT_FUTURE:["in ","${time}","y"],SECOND_LONG_PAST:["1 second ago"],SECONDS_LONG_PAST:["${time}"," seconds ago"],MINUTE_LONG_PAST:["1 min ago"],MINUTES_LONG_PAST:["${time}"," mins ago"],HOUR_LONG_PAST:["1 hour ago"],HOURS_LONG_PAST:["${time}"," hours ago"],DAY_LONG_PAST:["1 day ago"],DAYS_LONG_PAST:["${time}"," days ago"],MONTH_LONG_PAST:["1 month ago"],MONTHS_LONG_PAST:["${time}"," months ago"],YEAR_LONG_PAST:["1 year ago"],YEARS_LONG_PAST:["${time}"," years ago"],SECOND_SHORT_PAST:["1s ago"],SECONDS_SHORT_PAST:["${time}","s ago"],MINUTE_SHORT_PAST:["1m ago"],MINUTES_SHORT_PAST:["${time}","m ago"],HOUR_SHORT_PAST:["1h ago"],HOURS_SHORT_PAST:["${time}","h ago"],DAY_SHORT_PAST:["1d ago"],DAYS_SHORT_PAST:["${time}","d ago"],MONTH_SHORT_PAST:["1mo ago"],MONTHS_SHORT_PAST:["${time}","mo ago"],YEAR_SHORT_PAST:["1y ago"],YEARS_SHORT_PAST:["${time}","y ago"],NO_DATE:["-"]})},"@VERSION@",{requires:["intl"]});
YUI.add("group-menu-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create("group-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".large",".no-menu"].concat(e.excludeSelectors||[]),this.groupSelector=".avatar.group",this.dialogCache=[],this.currentDialog,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},activate:function(){this.registerEventHandler(e.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.groupSelector,this))},onClickTarget:function(e){var t;this.shouldProcessTarget(e.target)&&(e.preventDefault(),e.halt(),t=e.target,this.createParamsAndManageState(t))},shouldProcessTarget:function(e){return e.ancestor()!==null&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(e){var t={appContext:this.appContext,isActiveViewAgnostic:!0};return t.groupId=e.getData("group-nsid"),t.signature=t.groupId,t},createDialog:function(t,n){var r=this,i;this.fire("open"),this.dialogCache.some(function(e){return e.key===t.signature?(i=e.dialog,!0):!1}),i?i.set("anchorElement",n):(i=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,observePageResize:!0,anchorElement:n,subview:new e.Views["group-card-view"](t)}),i.on("clickOverlay",function(e){r.nextElClicked=[e.clientX,e.clientY]}),i.on("closeDroparound",function(){setTimeout(function(){if(r.nextElClicked){var t=document.elementFromPoint(r.nextElClicked[0],r.nextElClicked[1]),n;t&&(n=e.one(t),n&&r.groupSelector.split(",").some(function(e){return n.hasClass(e.replace(".",""))})&&r.shouldProcessTarget(n)&&r.createParamsAndManageState(n)),r.nextElClicked=null}},10)}),this.dialogCache.length>10&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:i})),this.currentDialog=i,i.show()},closeDialog:function(){this.currentDialog&&this.currentDialog.close()},destructor:function(){var t=this;this.currentDialog=null,e.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=null}})},"@VERSION@",{requires:["flickr-promise","flickr-view","account-menu-css","flickrui-css","dialog","fluid-droparound-view","group-card-view"],langBundles:["common"]});
YUI.add("science",function(e,t){e.Science=function(t){return e.Promise.resolve(t.getViewer())},e.mix(e.namespace("Science"),{signedIn:function(){return function(e){if(e.signedIn)return e;throw new Error("Viewer is not signed in")}},percentage:function(e){return function(t){var n=parseInt(t.nsid,10)%100;if(n<e)return t;throw new Error("Viewer is not in the percentage")}},load:function(t){return function(n){var r=e.StorageHelper.getItem(t);if(!r||r<Date.now())return n;throw new Error("Experiment has already been run")}},save:function(t,n){return function(){e.StorageHelper.setItem(t,Date.now()+n)}}})},"@VERSION@",{requires:["promise","storage-helper"]});
YUI.add("autosuggest-experiment",function(e,t){function i(e){return function(t){return e.callAPI("flickr.autosuggest.getContextResults",{context_type:"user",context_id:t.nsid})}}var n=864e5,r=100;e[t]=function(s){return e.Science(s).then(e.Science.signedIn()).then(e.Science.percentage(r)).then(e.Science.load(t)).then(i(s)).then(e.Science.save(t,n)).then(function(){e.Flog.debug("[%s]",t,"Experiment run and saved")},function(n){e.Flog.debug("[%s]",t,n.message)})}},"@VERSION@",{requires:["promise","science","flog"]});
YUI.add("global-nav-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var n,r;typeof t.enableBrowserUpgradeBanner=="undefined"&&(t.enableBrowserUpgradeBanner=!0),this.set("showBrowserUpgradeBanner",!1);if(YUI.Env.isServer&&t.enableBrowserUpgradeBanner){var i=this.appContext.request.headers["user-agent"],s=e.BrowserSupport.isUnsupportedBrowser(i),o=e.BrowserSupport.isBot(i),u=e.BrowserSupport.isSharingBot(i);s&&!o&&!u&&this.set("showBrowserUpgradeBanner",!0)}if(!YUI.Env.isServer){var a=e.StorageHelper.getItem("hasDismissedBrowserUpgradeBanner",!0);a&&a==="true"&&this.set("showBrowserUpgradeBanner",!1)}return this.get("container").get("innerHTML")===""&&this.setContainerHTML('<div class="global-nav-content"></div>'),this.appStateParams=t,this.enableMobileNav=t.enableMobileNav||!1,n=this.appContext.getLocation(),t.modelParams&&t.modelParams.apiParams?r=t.modelParams.apiParams:r=n.href,this.searchUrl=new e.SearchUrl(r,this.appContext,t.searchType),this.useGlobalNavRestyle=t.useGlobalNavRestyle,this},subviewConfig:{"search-autosuggest-field-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-new-autosuggest")}},"autosuggest-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("autosuggest2")}},"search-bar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("autosuggest")}},"account-menu-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"notifications-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("notifications-menu")}},"browser-upgrade-banner-view":{requiredToShowOnServer:!0,requiredToShowOnClient:!1,dealbreaker:!1,disabled:function(){return!this.get("showBrowserUpgradeBanner")}},"person-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-hover-account-menu")||!this.appContext.flipper.isFlipped("rebootify-group-discussions-list")}},"group-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-hover-account-menu")||!this.appContext.flipper.isFlipped("rebootify-group-discussions-list")}}},loadState:function(){var t=this,n=this.appContext.getViewer(),r;return n.signedIn?r=this.appContext.getModel("person-models",n.nsid).then(function(e){t.set("viewer",e),t.elementStates=t.setElementStates(t.appStateParams)}):(this.elementStates=this.setElementStates(this.appStateParams),r=e.Promise.resolve()),r},buildContainer:function(){var t={},n;return this.get("viewer")&&(t=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),n={"account-menu-view":this.subviews["account-menu-view"].get("container"),"browser-upgrade-banner-view":this.subviews["browser-upgrade-banner-view"]?this.subviews["browser-upgrade-banner-view"].get("container"):"","show-browser-upgrade-banner":this.get("showBrowserUpgradeBanner"),showNotificationsMenu:!1,viewer:t,elements:this.elementStates,enableMobileNav:this.enableMobileNav,enableNewAutosugest:this.appContext.flipper.isFlipped("enable-new-autosuggest"),showSmartSearchBar:this.appContext.flipper.isFlipped("autosuggest"),showAutosuggest:this.appContext.flipper.isFlipped("autosuggest2"),searchValue:this.searchUrl.getSearchTerm(),"person-menu-view":this.subviews["person-menu-view"]?this.subviews["person-menu-view"].get("container"):"","group-menu-view":this.subviews["group-menu-view"]?this.subviews["group-menu-view"].get("container"):""},n.showAutosuggest?n["autosuggest-view"]=this.subviews["autosuggest-view"].get("container"):n.showSmartSearchBar?n["search-bar-view"]=this.subviews["search-bar-view"].get("container"):n.enableNewAutosugest&&(n["search-autosuggest-field-view"]=this.subviews["search-autosuggest-field-view"].get("container")),this.appContext.flipper.isFlipped("notifications-menu")&&(n["notifications-menu-view"]=this.subviews["notifications-menu-view"].get("container"),n.showNotificationsMenu=!0),this.appContext.flipper.isFlipped("global-nav-restyle")||this.useGlobalNavRestyle?this.setContainerHTML(this.templates("global-nav-restyle")(n)):this.setContainerHTML(this.templates("global-nav")(n)),this},activate:function(){var t=this,n=this.appContext.getViewer().prefs.keyboardShortcutsEnabled,r,i=this.get("container");n&&this.attachKeyEvent("up:83",this.focusSearch.bind(this)),t.subviews["autosuggest-view"]&&(this.registerEventHandler(this.subviews["autosuggest-view"].on("open",function(e){t.subviews["account-menu-view"].closeMenu()})),this.registerEventHandler(this.subviews["account-menu-view"].on("open",function(e){t.subviews["autosuggest-view"].close()}))),this.elementStates.search_bar&&!this.appContext.flipper.isFlipped("enable-new-autosuggest")&&(r=i.one(".gn-tools form"),r&&this.registerEventHandler(r.on("submit",this.executeSearch.bind(this))));if(this.appContext.flipper.isFlipped("global-nav-restyle")||this.useGlobalNavRestyle)this.registerEventHandler(i.one(".mobile-nav-toggle").on("click",function(n){e.rapidTracker.beacon(t.name,"mobile-nav-toggle",{action:i.one(".global-nav-restyle").hasClass("menu-open")?"close":"open"}),i.one(".global-nav-restyle").toggleClass("menu-open")}.bind(this))),this.registerEventHandler(i.one(".mobile-search-button").on("click",function(n){e.rapidTracker.beacon(t.name,"mobile-nav-search");var r=this.get("container"),i=r.one(".global-nav-restyle"),s=r.one("#gn-search-field"),o=this.appContext.viewportData.getWidth(),u=37,a=46;i.addClass("search-open"),i.hasClass("menu-open")&&i.removeClass("menu-open"),t.appContext.flipper.isFlipped("enable-new-autosuggest"
)?(t.fire("parentViewEvent","resize-search-field",o-a),t.fire("parentViewEvent","focus-search-field")):(t.appContext.flipper.isFlipped("autosuggest")&&(s=r.one("#autosuggest-input"),a=42),s.setStyles({width:o-u-a+"px"}).focus())}.bind(this))),this.registerEventHandler(i.one(".mobile-search-close-button").on("click",function(e){i.one(".global-nav-restyle").removeClass("search-open"),t.appContext.flipper.isFlipped("autosuggest")?i.one(".global-nav-restyle #autosuggest-input").set("value",""):t.appContext.flipper.isFlipped("enable-new-autosuggest")?t.fire("parentViewEvent","clear-search-field"):i.one(".global-nav-restyle #gn-search-field").set("value","")}.bind(this))),this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){i.one(".global-nav-restyle").removeClass("search-open"),t.appContext.flipper.isFlipped("autosuggest")?i.one(".global-nav-restyle #autosuggest-input").set("value","").setStyles({width:"183px"}):t.appContext.flipper.isFlipped("enable-new-autosuggest")?t.fire("parentViewEvent","resize-search-field"):i.one(".global-nav-restyle #gn-search-field").set("value","").setStyles({width:"183px"})}.bind(this)));return e["autosuggest-experiment"](this.appContext),this},focusSearch:function(e){this.appContext.flipper.isFlipped("autosuggest")?this.subviews["search-bar-view"].get("container").one("#autosuggest-input").focus():this.appContext.flipper.isFlipped("enable-new-autosuggest")||this.get("container").one("#gn-search-field").focus()},executeSearch:function(e){var t=this.get("container").one("#gn-search-field").getDOMNode(),n;n=this.searchUrl.createNewSearch(t.value).getURL(),e.halt(),this.appContext.flapp.navigate(n)},setElementStates:function(e){var t={small_logo:!1,you_link:!1,you_menu:!1,contacts_menu:!1,groups_menu:!1,explore_menu:!1,weekly_flickr:!1,create_link:!1,create_menu:!1,upload_link:!1,upload_icon:!1,account_menu:!1,search_bar:!1,tour_link:!1,signup_link:!1,signin_link:!1,pro_upsell:!1,chronic_link:!1,editr_tour_link:!1,use_uh_eyebrow:!1},n=this.appContext.getViewer();return!this.appContext.flipper.isFlipped("global-nav-restyle")&&!this.useGlobalNavRestyle?(e.isJobs?t.small_logo=!0:e.isPlayr?t.use_uh_eyebrow=!1:e.isEditr?(t.small_logo=!0,t.you_link=!0,t.chronic_link=!0,t.editr_tour_link=!0,t.account_menu=!0,t.use_uh_eyebrow=!1):e.isHome&&!n.signedIn?(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0):n.signedIn?(t.you_menu=!0,t.contacts_menu=!0,t.groups_menu=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.account_menu=!0):(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0),this.get("viewer")&&this.get("viewer").getValue("isPro")&&(t.stats=!0),this.appContext.lang.toLowerCase()==="en-us"&&(t.weekly_flickr=!0),t.create_link=!0,t.set_not_album=!this.appContext.flipper.isFlipped("rename-set-to-album")):(e.isJobs?t.small_logo=!0:e.isPlayr?t.use_uh_eyebrow=!1:e.isEditr?(t.small_logo=!0,t.you_link=!0,t.chronic_link=!0,t.editr_tour_link=!0,t.account_menu=!0,t.use_uh_eyebrow=!1):e.isHome&&!n.signedIn?(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0):n.signedIn?(t.you_menu=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.account_menu=!0):(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0),this.get("viewer")&&this.get("viewer").getValue("isPro")&&(t.stats=!0),this.appContext.lang.toLowerCase()==="en-us"&&(t.weekly_flickr=!0),t.create_link=!0,t.set_not_album=!this.appContext.flipper.isFlipped("rename-set-to-album"),this.appContext.flipper.isFlipped("enable-global-nav-upload-icon")&&(t.upload_link=!1,t.upload_icon=!0)),t}})},"@VERSION@",{requires:["flickr-view","hermes-template-global-nav","hermes-template-global-nav-restyle","global-nav-css","global-nav-restyle-css","search-url","search-autosuggest-field-view","autosuggest-view","search-bar-view","querystring-parse-simple","querystring-stringify-simple","notifications-menu-view","fluid-css","url-helper","person-menu-view","group-menu-view","autosuggest-experiment","browser-support","storage-helper"],langBundles:["global-nav","common","search"]});
YUI.add("hermes-template-pagination-view",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function f(e,t){var r="",i;r+="\n\n	",i=n["if"].call(e,e.leftUrl,{hash:{},inverse:a.program(4,c,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n.each.call(e,e.pages,{hash:{},inverse:a.noop,fn:a.program(6,h,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.rightUrl,{hash:{},inverse:a.program(14,g,t),fn:a.program(12,m,t),data:t});if(i||i===0)r+=i;return r+="\n\n",r}function l(e,t){var r="",i;return r+='\n		<a href="',(i=n.leftUrl)?i=i.call(e,{hash:{},data:t}):(i=e.leftUrl,i=typeof i===o?i.apply(e):i),r+=u(i)+'" data-track="paginationLeftClick"><span><i class="page-arrow"></i></span></a>\n	',r}function c(e,t){return'\n		<span class="disabled"><i class="page-arrow"></i></span>\n	'}function h(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e.isMore,{hash:{},inverse:a.program(9,d,t),fn:a.program(7,p,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function p(e,t){return'\n			<span class="moredots">\u2022\u2022\u2022</span>\n		'}function d(e,t){var r="",i,s;r+='\n			<a href="'+u((i=e.url,typeof i===o?i.apply(e):i))+'" data-track="pagination'+u((i=e.text,typeof i===o?i.apply(e):i))+'Click"><span',s=n["if"].call(e,e.isCurrent,{hash:{},inverse:a.noop,fn:a.program(10,v,t),data:t});if(s||s===0)r+=s;return r+=">"+u((i=e.text,typeof i===o?i.apply(e):i))+"</span></a>\n		",r}function v(e,t){return' class="is-current"'}function m(e,t){var r="",i;return r+='\n		<a href="',(i=n.rightUrl)?i=i.call(e,{hash:{},data:t}):(i=e.rightUrl,i=typeof i===o?i.apply(e):i),r+=u(i)+'" data-track="paginationRightClick"><span><i class="page-arrow right"></i></span></a>\n	',r}function g(e,t){return'\n		<span class="disabled"><i class="page-arrow right"></i></span>\n	'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.unless.call(t,t.hide,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/pagination-view",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("pagination-view",function(e){var t=7,n=2;e.namespace("Views")[this.name]=e.Base.create("pagination-view",e.FlickrView,[],{initializer:function(e){return this.modelKey=e.pageParams&&e.pageParams.idAttribute?e[e.pageParams.idAttribute]:e.nsid,this.baseURL=e.baseURL.replace(/\/with\/[0-9]+/,""),this.modelRegistryName=e.modelRegistryName,this.maxNumAttrName=e.maxNumAttrName||"totalItems",this.pageParams=e.pageParams,this.paginationSuffix=e.paginationSuffix||"",this.hideMorePages=e.hideMorePages||!1,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this,t;return this.appContext.getModel(this.modelRegistryName,this.modelKey).then(function(n){e.model=n,e.numPages=Math.ceil(e.model.getValue(e.maxNumAttrName)/e.pageParams.viewPageSize),e.registerEventHandler(e.model.on("valuesChanged",function(n){n[e.maxNumAttrName]&&(t=Math.ceil(n[e.maxNumAttrName].newVal/e.pageParams.viewPageSize),t!==e.numPages&&(e.numPages=t,e.buildContainer()))}))})},buildContainer:function(){var t=[],n=this.baseURL+"page",r,i,s="";return YUI.Env.isServer?this.paginationSuffix&&(s=this.paginationSuffix):s=e.config.win.location.search,this.pageParams.nominalPage>1&&this.numPages>1&&(r=n+(this.pageParams.nominalPage-1).toString()+s),this.pageParams.nominalPage<this.numPages&&this.numPages>1&&(i=n+(this.pageParams.nominalPage+1).toString()+s),t=this.calcPages(n,s),this.setContainerHTML(this.templates("pagination-view")({leftUrl:r,rightUrl:i,pages:t,hide:t.length===1})),this},activate:function(){return this},calcPages:function(e,r){function u(t){var n=(t+1).toString();return{url:e+n+r,text:n,isMore:!1,isCurrent:i.pageParams.nominalPage===t+1}}var i=this,s=[],o;if(this.numPages<=t)for(o=0;o<this.numPages;o++)s.push(u(o));else if(this.pageParams.nominalPage<=t-1){for(o=0;o<t;o++)s.push(u(o));if(!this.hideMorePages){this.numPages>t+n&&s.push({isMore:!0});for(o=Math.max(t,this.numPages-n);o<this.numPages;o++)s.push(u(o))}}else if(this.pageParams.nominalPage>this.numPages-(t-1)){if(!this.hideMorePages){for(o=0;o<Math.min(this.numPages-t,n);o++)s.push(u(o));this.numPages>t+n&&s.push({isMore:!0})}for(o=this.numPages-t;o<this.numPages;o++)s.push(u(o))}else{if(!this.hideMorePages){for(o=0;o<n;o++)s.push(u(o));s.push({isMore:!0})}for(o=this.pageParams.nominalPage-Math.ceil(t/2);o<this.pageParams.nominalPage+Math.floor(t/2);o++)s.push(u(o));if(!this.hideMorePages){s.push({isMore:!0});for(o=this.numPages-n;o<this.numPages;o++)s.push(u(o))}}return s}})},"@VERSION@",{requires:["flickr-view","hermes-template-pagination-view","pagination-view-css"],optional:[]});
